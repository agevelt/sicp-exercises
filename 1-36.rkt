#lang sicp

(define tolerance 0.000001)

(define (fixed-point f initial-guess)
  (define (good-enough? a b)
    (< (abs (- a b)) tolerance))
  (define (print-guess x)
    (display x)
    (newline))
  (define (try f guess)
    (print-guess guess)
    (let ((next (f guess)))
      (if (good-enough? guess next)
          next
          (try f next))))
  (try f initial-guess))

(define (fx x)
  (/ (log 1000) (log x)))

(define (fx-dampened x)
  (/ (/ (+ (log 1000) x)
        (log x))
     2))

;; ï»¿> (fixed-point fx 1.5)
;; 1.5
;; 17.036620761802716
;; 2.436284152826871
;; 7.7573914048784065
;; 3.3718636013068974
;; 5.683217478018266
;; 3.97564638093712
;; 5.004940305230897
;; 4.2893976408423535
;; 4.743860707684508
;; 4.437003894526853
;; 4.6361416205906485
;; 4.503444951269147
;; 4.590350549476868
;; 4.532777517802648
;; 4.570631779772813
;; 4.545618222336422
;; 4.562092653795064
;; 4.551218723744055
;; 4.558385805707352
;; 4.553657479516671
;; 4.55677495241968
;; 4.554718702465183
;; 4.556074615314888
;; 4.555180352768613
;; 4.555770074687025
;; 4.555381152108018
;; 4.555637634081652
;; 4.555468486740348
;; 4.555580035270157
;; 4.555506470667713
;; 4.555554984963888
;; 4.5555229906097905
;; 4.555544090254035
;; 4.555530175417048
;; 4.555539351985717
;; 4.555533300207017
;; 4.55553729124088
;; 4.555534659227973
;; 4.555536394991131
;; 4.555535250287615
;; 4.555536005198178
;; Starting from a guess of 1.5, we need to apply 41 function calls before we are within the tolerance range using the regular function.


;; 1.5
;; 10.368037977683683
;; 3.693416830648335
;; 4.0569269764463
;; 3.9147673427224743
;; 3.9650030520096804
;; 3.9465357679785744
;; 3.9532303434388063
;; 3.950790996800028
;; 3.951678184030396
;; 3.9513552961810396
;; 3.9514727807839605
;; 3.9514300294955462
;; 3.95144558568668
;; 3.9514399250862833
;; 3.9514419848615803
;; 3.9514412353508113
;; Starting from a guess of 1.5, we need to apply 16 function calls before we are within the tolerance range using the dampened function.
